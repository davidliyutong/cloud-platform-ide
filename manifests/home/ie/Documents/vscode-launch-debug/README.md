# About how to configure launch.json and tasks.json to use debugging tools

First create a .vscode directory under the currently open project, and create the launch.json and tasks.json files in that directory, being careful not to get the filenames wrong. (Assume here that `scratch.c` is the code we are writing to run)

! [](img/c6afe7a2-227c-41d3-91ce-4ff4b9ebf045.png)

Overall, debugging tasks are managed by `launch.json`. Fill the following fields in launch.json. The meaning of the relevant fields is as follows

```json
{
    // Use IntelliSense to understand the relevant properties. 
    // Hover to see a description of the available properties.
    // For more information, please visit: https://go.microsoft.com/fwlink/?linkid=830387
    "version": "0.2.0",
    "configurations": [
        
        {
            "name": "C: gcc - Generate and debug active files", // Unique name
            "type": "cppdbg", // no need to change
            "request": "launch", // no need to change
            "program": "${fileDirname}/${fileBasenameNoExtension}", // path to the program to be launched, no need to modify, see below
            "args": [], // additional start parameters
            "stopAtEntry": false, // no need to change
            "cwd": "${fileDirname}", // the directory to run in, default is the current directory
            "environment": [], // additional environment variables
            "externalConsole": false, // if local, you can change to true to use scanf input; for cloud IDE please set to false
            "MIMode": "gdb", // debugging tool to be called, no need to change it
            "preLaunchTask": "C: gcc generate active file", // pre-running generation task, see below
        }
    ]
}
```

We can see that `launch.json` defines a debugging task called `C: gcc - Generate and debug activity files`. The target program for this task is `${fileDirname}/${fileBasenameNoExtension}`. When running this task, `${fileDirname}` is replaced with the specific directory and `${fileBasenameNoExtension}` is replaced with the *filename without extensions*. For example, for `./scratch.c`, the debugging tool will look for the `./scratch` program to run.

We should always be clear that the task defined in `launch.json` is always for the **binary**, not the source code. VSCode provides a `preLaunchTask` mechanism for this purpose. The tasks specified by `preLaunchTask` will run before the current task. These tasks are managed by `tasks.json`.

Fill in `tasks.json` with the following

```json
{
    "tasks": [
        {
            "type": "cppbuild", // do not modify
            "label": "C: gcc generate active file", // unique, matches the preLaunchTask in launch.json
            "command": "/usr/bin/gcc", // call gcc to compile
            "args": [
                "-fdiagnostics-color=always",
                "-g",
                "${file}", // source file
                "-o",
                "${fileDirname}/${fileBasenameNoExtension}" // generated file
            ], // compile parameters, modify as appropriate
            "options": {
                "cwd": "${fileDirname}" // working directory, modify as appropriate
            },
            "problemMatcher": [
                "$gcc" // no need to modify
            ],
            "group": { // no modifications needed
                "kind": "build",
                "isDefault": true
            },
            "detail": "Tasks generated by the debugger." // Random name
        }
    ],
    "version": "2.0.0"
}
```

This task defined in `task.json` will replace `${file}` with the current file and then compile `${fileDirname}/${fileBasenameNoExtension}`. Using the `scratch.c` file as an example, this task is equivalent to executing `gcc scratch.c -o ./scratch`

Now let's try it. First make sure that the scratch.c file is open and placed in the main panel. Then click on the debug tab. The debugging tool will automatically recognize the `launch.json` file and display a green run button

! [](img/a8f199dc-dbf2-4958-8dfa-0c67fb63d4d8.png)

Click this button to compile and run the program

! [](img/ad759341-a9f3-4584-9181-27ff795f11d4.png)

If a breakpoint is set, the program will stop at the breakpoint. The behavior of the program can be controlled from the debug panel

! [](img/797b85a7-1e66-4f47-8195-d7888ef9c2eb.png)
